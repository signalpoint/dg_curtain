var dg_curtain=new dg.Module;dg.modules.dg_curtain=dg_curtain,dg.theme_context_menu=function(t){t._context?t._context:{};return dg.theme("curtain",t)},dg._curtains={},dg_curtain._curtain=null,dg_curtain.getCurtain=function(){return dg_curtain._curtain},dg_curtain.setCurtain=function(t){dg_curtain._curtain=t},dg_curtain.clearCurtain=function(){dg_curtain._curtain=null},dg_curtain.getButton=function(){var t=dg_curtain.getCurtain();return t?document.getElementById(t._open.button._attributes.id):null},dg_curtain.getContainer=function(){var t=dg_curtain.getCurtain();return t?document.getElementById(t._attributes.id):null},dg_curtain.isOpen=function(){var t=dg_curtain.getContainer();return console.log(t),t&&"none"!=t.style.display},dg_curtain.close=function(){var t=dg_curtain.getButton();t&&t.click()},dg.theme_curtain=function(t){t._attributes.id||(t._attributes.id=dg.salt());var e=t._attributes.id;t._attributes.class.push("curtain");var n=t._open?t._open:{},r=n.button?n.button:{};r._attributes||(r._attributes={}),r._attributes.id||(r._attributes.id=dg.salt()),r._attributes.onclick||(r._attributes.onclick="dg._curtainClick(this, 'open')"),r._attributes.for||(r._attributes.for=e),dg._curtains[e]=t;var i=dg._curtains[e];return dg._curtainBtnWrapOpen(i)+dg._curtainButtonRender(r,i,"open")+dg._curtainBtnWrapClose(i)},dg._curtainBtnWrapOpen=function(t){var e=t._button_wrapper?t._button_wrapper:null;return e?(dg.elementAttributesInit(e),e._format||(e._format="div"),e._attributes.id="curtain-btn-wrapper-"+t._attributes.id,t._button_wrapper=e,"<"+e._format+" "+dg.attributes(e._attributes)+">"):""},dg._curtainBtnWrapClose=function(t){return t._button_wrapper?"</"+t._button_wrapper._format+">":""},dg._curtainButtonRender=function(t,e,n){var r=t._type?t._type:"link",i=t._text?t._text:"open"==n?"+":"-";return"link"==r?dg.l(i,null,t):dg.b(i,t)},dg._curtainClick=function(t,e){var n=t.getAttribute("for"),r=dg._curtains[n],i=!!r._context,u=!i&&r._panel,a="open"==e?"close":"open",_="_"+e,d="_"+a,c=t.getAttribute("id");r[_].before&&r[_].before(t,r);var o=null;if(!u){var s=r[d]?r[d]:{},l=s.button?s.button:{};l._attributes||(l._attributes={}),l._attributes.id=c,l._attributes.onclick||(l._attributes.onclick="dg._curtainClick(this, '"+a+"')"),l._attributes.for||(l._attributes.for=n);var g=document.createElement("div");g.innerHTML=dg._curtainButtonRender(l,r,a),o=g.firstChild,t.parentNode.replaceChild(o,t)}if("open"==e){var b=document.getElementById(n);if(b){var p=document.getElementById(n);u?p.style.width="250px":p.style.display="block"}else{var f=r._attributes.class;i?(f.push("context-menu"),r._context.side&&f.push("context-menu-"+r._context.side)):u&&f.push("side-panel",r._panel.side?"side-panel-"+r._panel.side:"side-panel-left");var m=r._format?variables._format:"div";g=document.createElement("div"),g.innerHTML="<"+m+" "+dg.attributes(r._attributes)+"></"+m+">",o?o.parentNode.insertBefore(g.firstChild,o.nextSibling):t.parentNode.insertBefore(g.firstChild,t.nextSibling);var v=dg.render(r._fill());if(u){var B=r._close?r._close:{},C=B.button?B.button:{};C._attributes||(C._attributes={}),C._attributes.id=c,C._attributes.onclick||(C._attributes.onclick="dg._curtainClick(this, 'close')"),C._attributes.for||(C._attributes.for=n),v=dg._curtainButtonRender(C,r,"close")+v}b=document.getElementById(n),b.innerHTML="open"==e?v:"",dg._postRender.push(function(){setTimeout(function(){i||u&&(document.getElementById(n).style.width="250px")},50)}),dg.runPostRenders()}dg_curtain.setCurtain(r)}else{var p=document.getElementById(n);u?p.style.width="0":p.style.display="none",dg_curtain.clearCurtain()}r[_].after&&setTimeout(function(){r[_].after(u?t:o,r)},1)};